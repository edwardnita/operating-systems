<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Lab/I/O/Zero-Copy/content/client-server-model">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Client-Server Model | Operating Systems</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost//operating-systems/Lab/I/O/Zero-Copy/content/client-server-model"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Client-Server Model | Operating Systems"><meta data-rh="true" name="description" content="Up to now we&#x27;ve avoided code snippets using TCP."><meta data-rh="true" property="og:description" content="Up to now we&#x27;ve avoided code snippets using TCP."><link data-rh="true" rel="canonical" href="http://localhost//operating-systems/Lab/I/O/Zero-Copy/content/client-server-model"><link data-rh="true" rel="alternate" href="http://localhost//operating-systems/Lab/I/O/Zero-Copy/content/client-server-model" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost//operating-systems/Lab/I/O/Zero-Copy/content/client-server-model" hreflang="x-default"><link rel="stylesheet" href="/operating-systems/assets/css/styles.17f22a47.css">
<link rel="preload" href="/operating-systems/assets/js/runtime~main.948ffbee.js" as="script">
<link rel="preload" href="/operating-systems/assets/js/main.02fab441.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/operating-systems/"><div class="navbar__logo"><img src="/operating-systems/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/operating-systems/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SO</b></a><a class="navbar__item navbar__link" href="/operating-systems/Introduction">Introduction</a><a class="navbar__item navbar__link" href="/operating-systems/Lecture">Lecture</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/operating-systems/Lab">Lab</a><a class="navbar__item navbar__link" href="/operating-systems/Assignments">Assignments</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Client-Server Model</h1><p>Up to now we&#x27;ve avoided code snippets using TCP.
Not anymore.
Keep in mind that all socket functions in the Berkeley API have very detailed and informative <code>man</code> pages.
For example, here are the <code>man</code> pages for <a href="https://linux.die.net/man/2/sendto" target="_blank" rel="noopener noreferrer"><code>sendto()</code></a> and <a href="https://linux.die.net/man/2/recvfrom" target="_blank" rel="noopener noreferrer"><code>recvfrom()</code></a> that are used with UDP sockets.</p><p>Going back to our <a href="/operating-systems/Lab/I/O/Zero-Copy/content/remote-io#one-browser---many-connections">initial example</a> with how the browser gets data from <a href="https://open-education-hub.github.io/operating-systems/" target="_blank" rel="noopener noreferrer">https://open-education-hub.github.io/operating-systems/</a>, by now we know the preferred method for transferring text is TCP.</p><p>Unlike UDP, TCP is <strong>connection-oriented</strong>.
This is why in the example with the browser we kept using the word <strong>connection</strong>.
What&#x27;s different from UDP is that this connection is <strong>bidirectional</strong>, so we can both <a href="https://man7.org/linux/man-pages/man2/send.2.html" target="_blank" rel="noopener noreferrer"><code>send()</code></a> and receive (<a href="https://man7.org/linux/man-pages/man2/recv.2.html" target="_blank" rel="noopener noreferrer"><code>recv()</code></a>) data from it.
Notice that the syscalls have changed.
We were using <code>sendto()</code> and <code>recvfrom()</code> for UDP and now we&#x27;re using <code>send()</code> and <code>recv()</code> for TCP.
And yes, despite the fact that we&#x27;re using Python, these are syscalls.
You saw them in C when you solved the <a href="/operating-systems/Lab/I/O/Zero-Copy/content/remote-io#practice-network-sockets-challenge">challenge</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="server-vs-client">Server vs Client<a class="hash-link" href="#server-vs-client" title="Direct link to heading">​</a></h2><p>When discussing servers and clients, the server is the passive actor.
It may have some data and wait for clients to ask for this data.
Or it may require some data and wait for clients to send it.
Either way, it is <strong>listening</strong> for connections.</p><p>The client is the active actor, being the one who initiates the connection.</p><p><a href="/operating-systems/Lab/I/O/Zero-Copy/quiz/client-server-sender-receiver">Quiz</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="establishing-the-connection">Establishing the Connection<a class="hash-link" href="#establishing-the-connection" title="Direct link to heading">​</a></h2><p>There is a series of steps that a client and most importantly a server must take to establish a TCP connection.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="steps-taken-by-the-server">Steps Taken by the Server<a class="hash-link" href="#steps-taken-by-the-server" title="Direct link to heading">​</a></h3><ol><li><p>Call <code>socket()</code> to create a socket.</p></li><li><p><code>bind()</code> this socket to an IP and a port.
Up to now, this is nothing new.
However, with TCP sockets, <code>bind()</code> doesn&#x27;t automatically make them listen for connectons.</p></li><li><p>Call <a href="https://man7.org/linux/man-pages/man2/listen.2.html" target="_blank" rel="noopener noreferrer"><code>listen()</code></a> to make the socket ready to receive connections.</p></li><li><p>Call <a href="https://man7.org/linux/man-pages/man2/accept.2.html" target="_blank" rel="noopener noreferrer"><code>accept()</code></a> to set up one connection initiated by a client.
From now, the connection is established.
<code>accept()</code> returns a new socket which is will be further used for communication between the server and the client.</p></li><li><p>Exchange messages with the client.
The server can both read messages from the client and send responses back using the same socket returned by <code>accept()</code>.
When done, <code>close()</code> the socket returned by accept and repeat from step <code>4</code>.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="steps-taken-by-the-client">Steps Taken by the Client<a class="hash-link" href="#steps-taken-by-the-client" title="Direct link to heading">​</a></h3><ol><li><p>Call <code>socket()</code> to create a socket.</p></li><li><p>Use <a href="https://man7.org/linux/man-pages/man2/connect.2.html" target="_blank" rel="noopener noreferrer"><code>connect()</code></a> to... you guessed it: connect to the server.
This step is like an &quot;answer&quot; to step <code>4</code> from the server.
We can say that the server <code>accept()</code>s a <code>connect()</code> request from the client.</p></li><li><p>Exchange messages with the server.
The client can both send messages to the server and read responses from it using the same socket created during step <code>1</code>.</p></li></ol><p>Below is an image summarising the steps above:</p><p><img loading="lazy" alt="Steps to Establish a Connection" src="/operating-systems/assets/images/connection-establishment-05ca0959a59f3204b866855631182875.svg" width="562" height="712" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="practice-client">Practice: Client<a class="hash-link" href="#practice-client" title="Direct link to heading">​</a></h3><p>Navigate to <code>support/client-server/</code>.
Here you will find a minimalistic server implementation in <code>server.py</code>.</p><ol><li><p>Read the code and identify the steps outlined above.</p></li><li><p>Run the code then run <code>lsof</code> and <code>netstat</code> in other terminals to identify the file descriptor corresponding to the listening file descriptor</p></li><li><p>Now fill in the code in <code>client.py</code> to be able to send messages to the server and receive responses from it.
Run multiple clients.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="practice-just-a-little-bit-more-deluge">Practice: Just a Little Bit More Deluge<a class="hash-link" href="#practice-just-a-little-bit-more-deluge" title="Direct link to heading">​</a></h2><p>We&#x27;ve already said that Deluge uses an <a href="/operating-systems/Lab/I/O/Zero-Copy/content/networking-101#practice-encapsulation-example-deluge-revived">abstraction over TCP</a> to handle socket operations, so we don&#x27;t have the luxury of seeing it perform remote I/O &quot;manually&quot;.
However, there are a few instances where Deluge uses socket operations itself, mostly for testing purposes.</p><p>Deluge saves its PIDs (it can spawn multiple processes) and ports in a file.
Find the <code>is_daemon_running()</code> method.
This method uses the aforementioned file to check if a given process is Deluge or some other process.
To do this, it <code>connect()</code>s to that process&#x27;s socket.
If it can&#x27;t then that process is not Deluge.
Otherwise it is Deluge and that connection is immediately closed :))
This may sound like a stupid way of checking whether a process is Deluge or not, but <em>if it&#x27;s stupid and it works, then it&#x27;s not stupid!</em></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#server-vs-client" class="table-of-contents__link toc-highlight">Server vs Client</a></li><li><a href="#establishing-the-connection" class="table-of-contents__link toc-highlight">Establishing the Connection</a><ul><li><a href="#steps-taken-by-the-server" class="table-of-contents__link toc-highlight">Steps Taken by the Server</a></li><li><a href="#steps-taken-by-the-client" class="table-of-contents__link toc-highlight">Steps Taken by the Client</a></li><li><a href="#practice-client" class="table-of-contents__link toc-highlight">Practice: Client</a></li></ul></li><li><a href="#practice-just-a-little-bit-more-deluge" class="table-of-contents__link toc-highlight">Practice: Just a Little Bit More Deluge</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://curs.upb.ro" target="_blank" rel="noopener noreferrer" class="footer__link-item">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ocw.cs.pub.ro/courses/so" target="_blank" rel="noopener noreferrer" class="footer__link-item">OCW<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/sisteme.de.operare/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 SO Team</div></div></div></footer></div>
<script src="/operating-systems/assets/js/runtime~main.948ffbee.js"></script>
<script src="/operating-systems/assets/js/main.02fab441.js"></script>
</body>
</html>